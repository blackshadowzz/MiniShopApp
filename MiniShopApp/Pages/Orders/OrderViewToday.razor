@using MiniShopApp.Models.Orders
@page "/orders/views/today"
@layout MainLayout
<PageTitle>Order Today</PageTitle>

<MudTabs Outlined="true">
    <MudTabPanel Text="Today" Icon="@Icons.Material.Filled.CalendarToday" >
        <MudTabs Outlined="false">
            <MudTabPanel Text="Card" Icon="@Icons.Material.Filled.GridView">
                <MudStack>
                    <MudTextField T="string" @bind-Text="filter" Placeholder="Search" Variant=Variant.Text Adornment="Adornment.End"
                                  AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium" Class="my-2"></MudTextField>
                </MudStack>
                <MudGrid>
                    @if (orders is not null && orders.Any())
                    {
                        @foreach (var order in orders)
                        {
                            <MudItem>
                                <MudCard Class="mb-2" Elevation="3" Style="width:250px;max-width:350px">
                                    <MudCardHeader>
                                        <CardHeaderContent >
                                            <MudText Typo="Typo.subtitle1">#@order.Id | @order.FirstName @order.LastName</MudText>
                                         
                                        </CardHeaderContent>
                                        
                                        <CardHeaderActions>
                                            <MudMenu Icon="@Icons.Material.Filled.MoreVert"
                                            AnchorOrigin="Origin.BottomLeft"
                                            TransformOrigin="Origin.TopRight"
                                            Dense=true
                                           
                                                     AriaLabel="Open menu">
                                                <MudMenuItem Label="Generate Receipt" />
                                                <MudMenuItem Label="Modify Order" />
                                                <MudMenuItem Label="Delete Order" />
                                            </MudMenu>
                                        </CardHeaderActions>
                                    </MudCardHeader>

                                    <MudCardContent>
                                        <MudText>Table: <b>@order.TableNumber</b></MudText>
                                        <MudText>Items: <b>@order.ItemCount</b></MudText>
                                        <MudText>Total: <b>@order.TotalPrice?.ToString("c2")</b></MudText>
                                        <MudDivider Class="my-2" />
                                        <MudList T="MiniShopApp.Models.Orders.ViewTbOrderDetails" Dense="true">
                                            @if (order.TbOrderDetails != null)
                                            {
                                                @foreach (var detail in order.TbOrderDetails)
                                                {
                                                    <MudListItem T="MiniShopApp.Models.Orders.ViewTbOrderDetails" Value="@detail">
                                                        <MudText>@detail.ItemName x @detail.Quantity = @detail.TotalPrice?.ToString("c2")</MudText>
                                                    </MudListItem>
                                                }
                                            }
                                        </MudList>
                                    </MudCardContent>
                                    <MudCardActions>
                                        <MudText Typo="Typo.caption">Date: @order.CreatedDT?.ToString("dd/MMM/yy hh:mm tt")</MudText>
                                    </MudCardActions>
                                </MudCard>
                            </MudItem>
                        }
                    }
                    else
                    {
                        <MudItem xs="12">
                            <MudText>No orders found for today.</MudText>
                        </MudItem>
                    }
                </MudGrid>
            </MudTabPanel>
            <MudTabPanel Text="Grid" Icon="@Icons.Material.Filled.ListAlt" >
                <MudTable Items="@orders" Hover="true" Dense="true" >
                    <HeaderContent>
                        <MudTh>Order #</MudTh>
                        <MudTh>Customer</MudTh>
                        <MudTh>Table</MudTh>
                        <MudTh>Items</MudTh>
                        <MudTh>Total</MudTh>
                        <MudTh>Date</MudTh>
                        <MudTh>Action</MudTh>
                    </HeaderContent>
                    <RowTemplate>
                        <MudTd DataLabel="Order #">@context.Id</MudTd>
                        <MudTd DataLabel="Customer">@context.FirstName @context.LastName</MudTd>
                        <MudTd DataLabel="Table">@context.TableNumber</MudTd>
                        <MudTd DataLabel="Items">@context.ItemCount</MudTd>
                        <MudTd DataLabel="Total">@context.TotalPrice?.ToString("c2")</MudTd>
                        <MudTd DataLabel="Date">@context.CreatedDT?.ToString("g")</MudTd>
                        <MudTd>
                            <MudMenu Icon="@Icons.Material.Filled.MoreVert"
                            Dense=true
                                     AnchorOrigin="Origin.BottomLeft"
                                     TransformOrigin="Origin.TopRight"
                                     AriaLabel="Open menu">
                                <MudMenuItem Label="Generate Receipt" />
                                <MudMenuItem Label="Modify Order" />
                                <MudMenuItem Label="Delete Order" />
                            </MudMenu>
                        </MudTd>
                    </RowTemplate>
                </MudTable>
            </MudTabPanel>
            
        </MudTabs>
    </MudTabPanel>
    <MudTabPanel Text="Yesterday" Icon="@Icons.Material.Filled.CalendarViewWeek" >

    </MudTabPanel>
    <MudTabPanel Text="Week" Icon="@Icons.Material.Filled.ViewWeek" >

    </MudTabPanel>
</MudTabs>


